<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rhino Ram</title>
  <style>
    :root{
      --glass:#ffffffcc;
      --muted:#64748b;
      --accent:#0ea5a4;
      --bg1:#f8fafc;
      --bg2:#eff6ff;
      --card:#ffffff;
      --radius:14px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#0f172a;}
    .wrap{max-width:1100px;margin:28px auto;padding:18px;display:grid;grid-template-columns:1fr 320px;gap:18px;align-items:start;}
    header{grid-column:1/-1;display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;}
    h1{font-size:22px;margin:0;}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:0 6px 18px rgba(2,6,23,0.06);padding:12px;}
    .canvas-wrap{border-radius:10px;overflow:hidden;background:linear-gradient(180deg,#fff,#f7fbff);display:flex;align-items:center;justify-content:center;padding:9px;}
    canvas{width:100%;height:auto;display:block;border-radius:8px;background:transparent;}
    .controls{display:flex;flex-direction:column;gap:10px;padding:8px;}
    .row{display:flex;gap:8px;align-items:center;}
    button{background:var(--accent);color:white;border:0;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600;}
    button.secondary{background:white;color:#0f172a;border:1px solid #e6eef6;}
    select,input{padding:8px;border-radius:8px;border:1px solid #e6eef6;background:white;}
    .muted{color:var(--muted);font-size:13px;}
    .small{font-size:13px;color:#0f172a;}
    .footer{grid-column:1/-1;margin-top:8px;color:var(--muted);font-size:13px;text-align:center;}
    .score-box{display:flex;gap:8px;align-items:center;}
    .pill{background:#ffffff;padding:6px 10px;border-radius:999px;box-shadow:0 2px 6px rgba(2,6,23,0.04);}
    .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none}
    .popup{pointer-events:auto;background:var(--card);padding:18px;border-radius:12px;box-shadow:0 10px 30px rgba(2,6,23,0.12);text-align:center}
    .instructions{font-size:13px;color:var(--muted)}
    @media (max-width:980px){
      .wrap{grid-template-columns:1fr; padding:12px;}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Rhino Ram</h1>
        <div class="muted">Chunky rhinos — dash to ram. Play vs bot (medium) or a friend.</div>
      </div>
      <div class="score-box">
        <div class="pill small">P1: <span id="scoreP1">0</span></div>
        <div class="pill small">P2: <span id="scoreP2">0</span></div>
      </div>
    </header>

    <div class="card canvas-wrap" style="position:relative;">
      <canvas id="gameCanvas" width="900" height="560" style="aspect-ratio:900/560;"></canvas>
      <div id="overlay" class="overlay" aria-hidden="true"></div>
    </div>

    <aside class="card controls">
      <div class="row">
        <button id="startBtn">Start</button>
        <button id="modeBtn" class="secondary">Mode: 1P</button>
      </div>

      <div class="row">
        <label class="small">Best of:&nbsp;</label>
        <select id="bestOf">
          <option value="1">1</option>
          <option value="3" selected>3</option>
          <option value="5">5</option>
        </select>
      </div>

      <div class="row instructions">
        <div><strong>Controls</strong></div>
      </div>
      <div class="row muted">
        <div><strong>P1:</strong> WASD — Move, Space — Dash</div>
      </div>
      <div class="row muted">
        <div><strong>P2:</strong> Arrow keys — Move, Enter — Dash</div>
      </div>

      <div style="margin-top:8px;">
        <div class="muted">Tip: dashing at close range with momentum beats an idle opponent. Mix directions to fool the bot.</div>
      </div>
    </aside>

    <div class="footer">Download this file as <code>index.html</code> and open it in a browser. For GitHub Pages, push to a repo and enable Pages.</div>
  </div>

<script>
(() => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const overlay = document.getElementById('overlay');
  const scoreP1El = document.getElementById('scoreP1');
  const scoreP2El = document.getElementById('scoreP2');
  const startBtn = document.getElementById('startBtn');
  const modeBtn = document.getElementById('modeBtn');
  const bestOfSel = document.getElementById('bestOf');

  let W = 900, H = 560;
  let DPR = window.devicePixelRatio || 1;

  function resizeCanvasToDisplay() {
    const cssW = canvas.clientWidth;
    const cssH = canvas.clientHeight;
    canvas.width = Math.max(1, Math.floor(cssW * DPR));
    canvas.height = Math.max(1, Math.floor(cssH * DPR));
    ctx.setTransform(DPR,0,0,DPR,0,0);
  }
  window.addEventListener('resize', () => { DPR = window.devicePixelRatio || 1; resizeCanvasToDisplay(); });

  let state = null;
  let running = false;
  let onePlayer = true;
  let scores = { p1:0, p2:0 };
  let needToStartAudio = true;

  const keys = {};
  window.addEventListener('keydown', (e) => { keys[e.key] = true; if (needToStartAudio) initAudio(); });
  window.addEventListener('keyup', (e) => { keys[e.key] = false; });

  let audioCtx = null;
  const SFX = {};
  function initAudio() {
    if (audioCtx) return;
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function tone(freq=440, type='sine', dur=0.12, vol=0.14, shape='adsr') {
      return () => {
        const now = audioCtx.currentTime;
        const osc = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, now);
        if (shape === 'adsr') {
          g.gain.setValueAtTime(0.0001, now);
          g.gain.exponentialRampToValueAtTime(vol, now + 0.01);
          g.gain.exponentialRampToValueAtTime(0.001, now + dur);
        } else {
          g.gain.setValueAtTime(vol, now);
          g.gain.linearRampToValueAtTime(0.0001, now + dur);
        }
        osc.connect(g).connect(audioCtx.destination);
        osc.start(now);
        osc.stop(now + dur + 0.02);
      };
    }
    SFX.dash = tone(520,'sawtooth',0.08,0.14);
    SFX.hit = tone(160,'square',0.18,0.18);
    SFX.point = tone(660,'triangle',0.28,0.22);
    SFX.win = tone(920,'sine',0.5,0.28);
    needToStartAudio = false;
  }

  function makePlayer(x,y,color){
    return { x,y,vx:0,vy:0, radius:28,color, maxSpeed:220,accel:1400,friction:6,dashCooldown:0,dashing:0, dashPower:420, immobile:0 };
  }

  function resetState() {
    state = { W, H, p1: makePlayer(W*0.25, H/2, '#6B7280'), p2: makePlayer(W*0.75, H/2, '#10B981'), roundTime:0 };
    scores = { p1:0, p2:0 };
    updateScoreUI();
  }

  function startMatch() {
    resetState();
    running = true;
    winnerOverlay(null);
    if (audioCtx === null) initAudio();
  }

  function endMatch(winnerName) {
    running = false;
    winnerOverlay(winnerName);
    if (audioCtx && SFX.win) SFX.win();
  }

  function updateScoreUI(){ scoreP1El.textContent = scores.p1; scoreP2El.textContent = scores.p2; }

  function integrate(p, dt) {
    p.vx *= (1 - Math.min(0.9, dt * p.friction));
    p.vy *= (1 - Math.min(0.9, dt * p.friction));
    const sp = Math.hypot(p.vx, p.vy);
    const max = p.maxSpeed * 1.6;
    if (sp > max) { p.vx *= max/sp; p.vy *= max/sp; }
    p.x += p.vx * dt; p.y += p.vy * dt;
    p.x = Math.max(p.radius, Math.min(W - p.radius, p.x));
    p.y = Math.max(p.radius, Math.min(H - p.radius, p.y));
  }

  // Preload images
  const rhinoBodyImg = new Image();
  rhinoBodyImg.src = '15c22c9a-7a86-4d0a-b5e6-4a506892f3d1.png';

  const rhinoHeadImg = new Image();
  rhinoHeadImg.src = '0f6de30e-14bd-4c73-9afc-cdfed1194451.avif';

  // Draw rhino using body + head images
  function drawRhino(p){
    ctx.save();
    ctx.translate(p.x,p.y);

    // Shadow
    ctx.beginPath();
    ctx.ellipse(0,10,p.radius*1.2,p.radius*0.6,0,0,Math.PI*2);
    ctx.fillStyle='rgba(2,6,23,0.08)';
    ctx.fill();

    // Body
    const bodyWidth = p.radius*2.4;
    const bodyHeight = p.radius*1.6;
    ctx.drawImage(rhinoBodyImg,-bodyWidth/2,-bodyHeight/2,bodyWidth,bodyHeight);

    // Head
    const headWidth = p.radius*1.2;
    const headHeight = p.radius*1.2;
    ctx.drawImage(rhinoHeadImg,-headWidth/2,-bodyHeight/2-headHeight/2+4,headWidth,headHeight);

    // Dash streak
    if(p.dashing){
      ctx.globalAlpha = Math.min(1,p.dashing*6);
      ctx.beginPath();
      ctx.moveTo(-p.radius*0.7,0);
      ctx.lineTo(-p.radius*2.6,-6);
      ctx.lineTo(-p.radius*2.2,6);
      ctx.closePath();
      ctx.fillStyle='rgba(255,255,255,0.32)';
      ctx.fill();
      ctx.globalAlpha = 1;
    }

    ctx.restore();
  }

  // The rest of your original code: collisions, controls, update, render, UI wiring
  // ... keep as in your original code

})();
</script>
</body>
</html>
